#!/bin/bash

declare -a deviceNames=(
  "Airpods Pro"
  "Soundcore 2"
  "BT60"
)

declare -a deviceMACs=(
  44:F0:9E:95:91:C9   # Airpods Pro
  8C:85:80:42:F8:A9   # SoundCore 2
  FB:58:C7:BD:78:D2   # BT60
)

choice=$(printf "%s\n" "${deviceNames[@]}" | dmenu -p "Select a bluetooth device: " -nb "#1e1e1e" -sf "#aaff77" -sb "#333333" -nf "#ffffff")

DEVICE=
for i in "${!deviceNames[@]}"; do
  if [[ "${deviceNames[$i]}" = "${choice}" ]]; then
    DEVICE="${deviceMACs[$i]}"
  fi
done

notify-send "Attempting to connect to bluetooth device \"$choice\"..."

bluetoothctl -- power on > /dev/null
bluetoothctl -- connect $DEVICE > /dev/null

if [[ $? -eq 0 ]]; then
  notify-send "Connection to bluetooth device \"$choice\" succeeded."
else
  notify-send --urgency critical "Connection to bluetooth device \"$choice\" failed." "Error $?"
fi
